---
layout : post
title: 검정(Statistical Hypothesis Testing)
author: Hojoon_Kim
date: 2024-03-09 14:15:10 +0900
categories: [Statistic, Statistic hypothesis testing]
tags: [Statistic, Statistic hypothesis testing]
pin: true
math: true
---
## 검정의 기본원리

검정은 통계적 가설검정이라고도 하며, 모집단의 모수에 대한 가설을 검정하는 것을 말한다. 검정은 가설을 세우고, 가설을 검정하는 절차로 이루어진다. 검정의 기본원리는 다음과 같다.

### 가설의 설정

검정의 첫 번째 단계는 가설을 설정하는 것이다. 가설은 귀무가설과 대립가설로 나눌 수 있다. 귀무가설은 기존의 가설로, 대립가설은 새로운 가설로 설정한다. 귀무가설은 기존의 가설이 참이라고 가정하고, 대립가설은 새로운 가설이 참이라고 가정한다.   
보통 귀무가설은 예측하고자 하는 것의 부정적인 가설로 설정하고, 대립가설은 예측하고자 하는 것의 긍정적인 가설로 설정한다.

### 유의수준의 설정

검정의 두 번째 단계는 유의수준을 설정하는 것이다. 유의수준은 귀무가설이 기각되는 최대 허용오차를 말한다. 유의수준은 보통 0.05, 0.01로 설정한다. 유의수준이 0.05라는 것은 귀무가설이 참이라고 가정했을 때, 귀무가설이 기각될 확률이 5%라는 것을 의미한다.

### 가설검정의 오류

가설검정은 제 1종 오류와 제 2종 오류로 나눌 수 있다. 제 1종 오류는 귀무가설이 참임에도 불구하고 귀무가설을 기각하는 오류를 말한다. 제 2종 오류는 대립가설이 참임에도 불구하고 귀무가설을 기각하지 않는 오류를 말한다. 제 1종 오류와 제 2종 오류는 서로 trade-off 관계에 있다. 즉, 제 1종 오류를 줄이면 제 2종 오류가 증가하고, 제 2종 오류를 줄이면 제 1종 오류가 증가한다.

|  | 귀무가설이 참 | 귀무가설이 거짓 |
|---|---|---|
| 귀무가설을 기각 | 제 1종 오류 | 올바른 결정 |
| 귀무가설을 기각하지 않음 | 올바른 결정 | 제 2종 오류 |

### 가설검정의 형태

가설검정은 단측검정과 양측검정으로 나눌 수 있다. 단측검정은 귀무가설이 참이라고 가정했을 때, 귀무가설을 기각하는 방향으로 설정한다. 양측검정은 귀무가설이 참이라고 가정했을 때, 귀무가설을 기각하는 방향으로 설정한다.

모수 $\theta$에 대한 가설검정의 형태는 다음과 같다.

- 단측검정
  - $H_0 : \theta = \theta_0$ vs $H_1 : \theta > \theta_0$
  - $H_0 : \theta = \theta_0$ vs $H_1 : \theta < \theta_0$
- 양측검정
    - $H_0 : \theta = \theta_0$ vs $H_1 : \theta \neq \theta_0$

- 우단측검정일 때의 기각역
    - $H_1 : \theta > \theta_0$일 때, 기각역은 $Z > Z_{\alpha}$이다.
- 좌단측검정일 때의 기각역
    - $H_1 : \theta < \theta_0$일 때, 기각역은 $Z < -Z_{\alpha}$이다.
- 양측검정일 때의 기각역
    - $H_1 : \theta \neq \theta_0$일 때, 기각역은 $Z > Z_{\alpha/2}$ 또는 $Z < -Z_{\alpha/2}$이다.

### 가설검정문제의 해결 순서
1. 귀무가설과 대립가설을 설정한다.
2. 유의수준을 설정한다.
3. 검정통계량을 설정한다.
4. 기각역을 구한다.
5. 주어진 자료로부터 유의성을 판단하고, 결과를 해석한다.

## 모평균의 검정

귀무가설 $ H_0 : \mu = \mu_0 $ 를 검정한다고 할 때, 이 검정을 모평균의 검정이라고 한다. 모평균의 검정은 단일 집단의 모평균 검정과 두 집단의 모평균 검정으로 나눌 수 있다.

### 단일 집단의 모평균 검정

### 모분산을 아는 경우 모평균 $\mu$ 검정

모분산 $\sigma^2$을 알고 있는 경우 모평균 $\mu$의 검정은 아래와 같이 수행한다.

- 귀무가설 설정 : $H_0 : \mu = \mu_0$
- 검정통계량 : $Z = \frac{\bar{X} - \mu_0}{\frac{\sigma}{\sqrt{n}}}$
- 가설검정:
    - 우측검정 : $H_1 : \mu > \mu_0$일 때, $Z > Z_{\alpha}$이면 귀무가설을 기각한다.
    - 좌측검정 : $H_1 : \mu < \mu_0$일 때, $Z < -Z_{\alpha}$이면 귀무가설을 기각한다.
    - 양측검정 : $H_1 : \mu \neq \mu_0$일 때, $Z > Z_{\alpha/2}$ 또는 $Z < -Z_{\alpha/2}$이면 귀무가설을 기각한다.


### 모분산을 모르는 경우 모평균 $\mu$ 검정

모분산을 모르지만, 대표본일 경우 모평균 $\mu$의 검정은 $\sigma^2$ 대신 표본분산 $S^2$로 대체하면 $\bar{X}$의 분포는 정규분포를 따르기 때문에, 아래와 같이 수행한다.

- 귀무가설 설정 : $H_0 : \mu = \mu_0$
- 검정통계량 : $T_0 = \frac{\bar{X} - \mu_0}{\frac{S}{\sqrt{n}}}$
- 가설검정:
    - 우측검정 : $H_1 : \mu > \mu_0$일 때, $T_0 > t_{\alpha}$이면 귀무가설을 기각한다.
    - 좌측검정 : $H_1 : \mu < \mu_0$일 때, $T_0 < -t_{\alpha}$이면 귀무가설을 기각한다.
    - 양측검정 : $H_1 : \mu \neq \mu_0$일 때, $T_0 > t_{\alpha/2}$ 또는 $T_0 < -t_{\alpha/2}$이면 귀무가설을 기각한다.

### 두 집단의 모평균의 동일성에 대한 검정

#### 두 모분산을 아는 경우

두 모분산을 알고 있는 경우 두 모평균의 동일성에 대한 검정은 아래와 같이 수행한다.

- 귀무가설 설정 : $H_0 : \mu_1 = \mu_2$
- 검정통계량 : $Z = \frac{\bar{X_1} - \bar{X_2}}{\sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}}$
- 가설검정:
    - 우측검정 : $H_1 : \mu_1 > \mu_2$일 때, $Z > Z_{\alpha}$이면 귀무가설을 기각한다.
    - 좌측검정 : $H_1 : \mu_1 < \mu_2$일 때, $Z < -Z_{\alpha}$이면 귀무가설을 기각한다.
    - 양측검정 : $H_1 : \mu_1 \neq \mu_2$일 때, $Z > Z_{\alpha/2}$ 또는 $Z < -Z_{\alpha/2}$이면 귀무가설을 기각한다.

#### 두 모분산을 모르는 경우

두 모분산을 모르지만, 대표본일 경우 두 모평균의 동일성에 대한 검정은 아래와 같이 수행한다.

##### 대표본일 경우

###### 두 모분산이 같은 경우($\sigma_1^2 = \sigma_2^2$)

두 모분산이 같은 경우에는 합동분산추정량 $s_p^2$을 사용하여 $\bar{X_1} - \bar{X_2}$ 의 t-통계량은 다음과 같다.

$$ t = \frac{\bar{X_1} - \bar{X_2} }{s_p\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}} $$

따라서, 두 모분산이 같은 경우 두 모평균 $\mu_1 - \mu_2$의 차이에 대한 검정은 아래와 같이 수행한다.

- 귀무가설 설정 : $H_0 : \mu_1 = \mu_2$
- 검정통계량 : $T_0 = \frac{\bar{X_1} - \bar{X_2} }{s_p\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}$
- 가설검정:
    - 우측검정 : $H_1 : \mu_1 > \mu_2$일 때, $T_0 > t_{\alpha}$이면 귀무가설을 기각한다.
    - 좌측검정 : $H_1 : \mu_1 < \mu_2$일 때, $T_0 < -t_{\alpha}$이면 귀무가설을 기각한다.
    - 양측검정 : $H_1 : \mu_1 \neq \mu_2$일 때, $T_0 > t_{\alpha/2}$ 또는 $T_0 < -t_{\alpha/2}$이면 귀무가설을 기각한다.

###### 두 모분산이 다른 경우($\sigma_1^2 \neq \sigma_2^2$)

두 모분산이 다른 경우에는 두 모평균 $\mu_1 - \mu_2$의 차이에 대한 검정은 아래와 같이 수행한다.

- 귀무가설 설정 : $H_0 : \mu_1 = \mu_2$
- 검정통계량 : $T_0 = \frac{\bar{X_1} - \bar{X_2} }{\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}}$

따라서, 두 모분산이 다른 경우 두 모평균 $\mu_1 - \mu_2$의 차이에 대한 검정은 아래와 같이 수행한다.

- 귀무가설 설정 : $H_0 : \mu_1 = \mu_2$
- 검정통계량 : $T_0 = \frac{\bar{X_1} - \bar{X_2} }{\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}}$
- 가설검정:
    - 우측검정 : $H_1 : \mu_1 > \mu_2$일 때, $T_0 > t_{\alpha}$이면 귀무가설을 기각한다.
    - 좌측검정 : $H_1 : \mu_1 < \mu_2$일 때, $T_0 < -t_{\alpha}$이면 귀무가설을 기각한다.
    - 양측검정 : $H_1 : \mu_1 \neq \mu_2$일 때, $T_0 > t_{\alpha/2}$ 또는 $T_0 < -t_{\alpha/2}$이면 귀무가설을 기각한다.


##### 소표본일 경우

###### 두 모분산이 같은 경우($\sigma_1^2 = \sigma_2^2$)

두 모분산이 같은 경우에는 합동분산추정량 $s_p^2$을 사용하여 $\bar{X_1} - \bar{X_2}$ 의 t-통계량은 다음과 같다.

$$ t = \frac{\bar{X_1} - \bar{X_2} }{s_p\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}} $$

따라서, 두 모분산이 같은 경우 두 모평균 $\mu_1 - \mu_2$의 차이에 대한 검정은 아래와 같이 수행한다.

- 귀무가설 설정 : $H_0 : \mu_1 = \mu_2$

- 검정통계량 : $T_0 = \frac{\bar{X_1} - \bar{X_2} }{s_p\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}$

- 가설검정:
    - 우측검정 : $H_1 : \mu_1 > \mu_2$일 때, $T_0 > t_{\alpha}$이면 귀무가설을 기각한다.
    - 좌측검정 : $H_1 : \mu_1 < \mu_2$일 때, $T_0 < -t_{\alpha}$이면 귀무가설을 기각한다.
    - 양측검정 : $H_1 : \mu_1 \neq \mu_2$일 때, $T_0 > t_{\alpha/2}$ 또는 $T_0 < -t_{\alpha/2}$이면 귀무가설을 기각한다.

###### 두 모분산이 다른 경우($\sigma_1^2 \neq \sigma_2^2$)

두 모분산이 다른 경우에는 두 모평균 $\mu_1 - \mu_2$의 차이에 대한 검정은 아래와 같이 수행한다.

- 귀무가설 설정 : $H_0 : \mu_1 = \mu_2$
- 검정통계량 : $T_0 = \frac{\bar{X_1} - \bar{X_2} }{\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}}$
- 가설검정:
    - 우측검정 : $H_1 : \mu_1 > \mu_2$일 때, $T_0 > t_{\alpha}$이면 귀무가설을 기각한다.
    - 좌측검정 : $H_1 : \mu_1 < \mu_2$일 때, $T_0 < -t_{\alpha}$이면 귀무가설을 기각한다.
    - 양측검정 : $H_1 : \mu_1 \neq \mu_2$일 때, $T_0 > t_{\alpha/2}$ 또는 $T_0 < -t_{\alpha/2}$이면 귀무가설을 기각한다.


## 모분산의 검정

### 단일 집단의 모분산 검정

#### 모평균 $\mu$를 알고 있는 경우 모분산 $\sigma^2$ 검정

모평균 $\mu$를 알고 있는 경우 모분산 $\sigma^2$의 구간추정에 의하면, 다음의 $\chi^2$-통계량 

$$ \chi^2 = \frac{(n-1)S^2}{\sigma^2} $$

은 자유도가 $n$인 카이제곱분포를 따른다. 따라서, 모분산 $\sigma^2$에 대한 검정은 다음과 같이 수행한다.

- 귀무가설 설정 : $H_0 : \sigma^2 = \sigma_0^2$
- 검정통계량 : $\chi_0^2 = \sum_{i=1}^{n}\frac{(X_i - \mu)^2}{\sigma_0^2}$
- 가설검정 :
    - 우측검정 : $H_1 : \sigma^2 > \sigma_0^2$일 때, $\chi_0^2 > \chi_{\alpha}^2$이면 귀무가설을 기각한다.
    - 좌측검정 : $H_1 : \sigma^2 < \sigma_0^2$일 때, $\chi_0^2 < \chi_{\alpha}^2$이면 귀무가설을 기각한다.
    - 양측검정 : $H_1 : \sigma^2 \neq \sigma_0^2$일 때, $\chi_0^2 > \chi_{\alpha/2}^2$ 또는 $\chi_0^2 < \chi_{\alpha/2}^2$이면 귀무가설을 기각한다.

#### 모평균 $\mu$를 모르는 경우 모분산 $\sigma^2$ 검정

모평균 $\mu$를 모르는 경우 모분산 $\sigma^2$의 구간추정에 의하면, 다음의 $\chi^2$-통계량

$$ \chi^2 = \frac{(n-1)S^2}{\sigma^2} $$

은 자유도가 $n-1$인 카이제곱분포를 따른다. 따라서, 모분산 $\sigma^2$에 대한 검정은 다음과 같이 수행한다.

- 귀무가설 설정 : $H_0 : \sigma^2 = \sigma_0^2$
- 검정통계량 : $\chi_0^2 = \frac{(n-1)S^2}{\sigma_0^2}$
- 가설검정 :
    - 우측검정 : $H_1 : \sigma^2 > \sigma_0^2$일 때, $\chi_0^2 > \chi_{\alpha}^2$이면 귀무가설을 기각한다.
    - 좌측검정 : $H_1 : \sigma^2 < \sigma_0^2$일 때, $\chi_0^2 < \chi_{\alpha}^2$이면 귀무가설을 기각한다.
    - 양측검정 : $H_1 : \sigma^2 \neq \sigma_0^2$일 때, $\chi_0^2 > \chi_{\alpha/2}^2(n-1)$ 또는 $\chi_0^2 < \chi_{\alpha/2}^2(n-1)$이면 귀무가설을 기각한다.

### 두 집단의 모분산의 동일성에 대한 검정


두 정규모집단 $N(\mu_1, \sigma_1^2)$, $N(\mu_2, \sigma_2^2)$ 으로부터 크기가 각각 $n_1$, $n_2$인 서로 독립인 임의표본의 표본분산을 각각 $S_1^2$, $S_2^2$이라고 할 때, 통계량

$$ F = \frac{S_1^2}{\sigma_1^2} / \frac{S_2^2}{\sigma_2^2} $$

은 자유도가 $n_1-1$, $n_2-1$인 F-분포를 따른다. 따라서, 두 모분산 $\sigma_1^2$, $\sigma_2^2$의 동일성에 대한 검정은 다음과 같이 수행한다.

- 귀무가설 설정 : $H_0 : \sigma_1^2 = \sigma_2^2$
- 검정통계량 : $F_0 = \frac{S_1^2}{S_2^2}$
- 가설검정 :
    - 우측검정 : $H_1 : \sigma_1^2 > \sigma_2^2$일 때, $F_0 > F_{\alpha}(n_1-1, n_2-1)$이면 귀무가설을 기각한다.
    - 좌측검정 : $H_1 : \sigma_1^2 < \sigma_2^2$일 때, $F_0 < F_{\alpha}(n_1-1, n_2-1)$이면 귀무가설을 기각한다.
    - 양측검정 : $H_1 : \sigma_1^2 \neq \sigma_2^2$일 때, $F_0 > F_{\alpha/2}(n_1-1, n_2-1)$ 또는 $F_0 < F_{\alpha/2}(n_1-1, n_2-1)$이면 귀무가설을 기각한다.


## 식 정리

### 단일집단의 모평균 $\mu$에 대한 검정

| 모분산을 아는 경우 | 모분산을 모르는 경우 |
|---|---|
| $Z = \frac{\bar{X} - \mu_0}{\frac{\sigma}{\sqrt{n}}}$ | $T_0 = \frac{\bar{X} - \mu_0}{\frac{S}{\sqrt{n}}}$ |
| $H_1 : \mu > \mu_0$일 때, $Z > Z_{\alpha}$ | $H_1 : \mu > \mu_0$일 때, $T_0 > t_{\alpha}$ |
| $H_1 : \mu < \mu_0$일 때, $Z < -Z_{\alpha}$ | $H_1 : \mu < \mu_0$일 때, $T_0 < -t_{\alpha}$ |
| $H_1 : \mu \neq \mu_0$일 때, $Z > Z_{\alpha/2}$ 또는 $Z < -Z_{\alpha/2}$ | $H_1 : \mu \neq \mu_0$일 때, $T_0 > t_{\alpha/2}$ 또는 $T_0 < -t_{\alpha/2}$ |

### 두 모평균의 동일성에 대한 검정

|두 모분산을 아는 경우 |
|-|
| $Z = \frac{\bar{X_1} - \bar{X_2} }{\sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}}$ |
| $H_1 : \mu_1 > \mu_2$일 때, $Z > Z_{\alpha}$ |
| $H_1 : \mu_1 < \mu_2$일 때, $Z < -Z_{\alpha}$ |
| $H_1 : \mu_1 \neq \mu_2$일 때, $Z > Z_{\alpha/2}$ 또는 $Z < -Z_{\alpha/2}$ |


| 두 모분산 모르는 경우| 두 모분산이 같다는 근거 있음 | 두 모분산이 같다는 근거 없음 |
|---|---|---|
|대표본| $T_0 = \frac{\bar{X_1} - \bar{X_2} }{s_p\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}$ | $T_0 = \frac{\bar{X_1} - \bar{X_2} }{\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}}$ |
|| $H_1 : \mu_1 > \mu_2$일 때, $T_0 > t_{\alpha}$ | $H_1 : \mu_1 > \mu_2$일 때, $T_0 > t_{\alpha}$ |
|| $H_1 : \mu_1 < \mu_2$일 때, $T_0 < -t_{\alpha}$ | $H_1 : \mu_1 < \mu_2$일 때, $T_0 < -t_{\alpha}$ |
|| $H_1 : \mu_1 \neq \mu_2$일 때, $T_0 > t_{\alpha/2}$ 또는 $T_0 < -t_{\alpha/2}$ | $H_1 : \mu_1 \neq \mu_2$일 때, $T_0 > t_{\alpha/2}$ 또는 $T_0 < -t_{\alpha/2}$ |
|소표본| $T_0 = \frac{\bar{X_1} - \bar{X_2} }{s_p\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}$ | $T_0 = \frac{\bar{X_1} - \bar{X_2} }{\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}}$ |
|| $H_1 : \mu_1 > \mu_2$일 때, $T_0 > t_{\alpha}$ | $H_1 : \mu_1 > \mu_2$일 때, $T_0 > t_{\alpha}$ |
|| $H_1 : \mu_1 < \mu_2$일 때, $T_0 < -t_{\alpha}$ | $H_1 : \mu_1 < \mu_2$일 때, $T_0 < -t_{\alpha}$ |
|| $H_1 : \mu_1 \neq \mu_2$일 때, $T_0 > t_{\alpha/2}$ 또는 $T_0 < -t_{\alpha/2}$ | $H_1 : \mu_1 \neq \mu_2$일 때, $T_0 > t_{\alpha/2}$ 또는 $T_0 < -t_{\alpha/2}$ |

### 단일집단의 모분산 $\sigma^2$에 대한 검정

| 모평균을 아는 경우 | 모평균을 모르는 경우 |
|---|---|
| $\chi_0^2 = \sum_{i=1}^{n}\frac{(X_i - \mu)^2}{\sigma_0^2}$ | $\chi_0^2 = \frac{(n-1)S^2}{\sigma_0^2}$ |
| $H_1 : \sigma^2 > \sigma_0^2$일 때, $\chi_0^2 > \chi_{\alpha}^2$ | $H_1 : \sigma^2 > \sigma_0^2$일 때, $\chi_0^2 > \chi_{\alpha}^2$ |
| $H_1 : \sigma^2 < \sigma_0^2$일 때, $\chi_0^2 < \chi_{\alpha}^2$ | $H_1 : \sigma^2 < \sigma_0^2$일 때, $\chi_0^2 < \chi_{\alpha}^2$ |
| $H_1 : \sigma^2 \neq \sigma_0^2$일 때, $\chi_0^2 > \chi_{\alpha/2}^2$ 또는 $\chi_0^2 < \chi_{\alpha/2}^2$ | $H_1 : \sigma^2 \neq \sigma_0^2$일 때, $\chi_0^2 > \chi_{\alpha/2}^2$ 또는 $\chi_0^2 < \chi_{\alpha/2}^2$ |

### 두 모분산의 동일성에 대한 검정

| |
|-|
| $F_0 = \frac{S_1^2}{S_2^2}$ |
| $H_1 : \sigma_1^2 > \sigma_2^2$일 때, $F_0 > F_{\alpha}(n_1-1, n_2-1)$ |
| $H_1 : \sigma_1^2 < \sigma_2^2$일 때, $F_0 < F_{\alpha}(n_1-1, n_2-1)$ |
| $H_1 : \sigma_1^2 \neq \sigma_2^2$일 때, $F_0 > F_{\alpha/2}(n_1-1, n_2-1)$ 또는 $F_0 < F_{\alpha/2}(n_1-1, n_2-1)$ |

## P-value
p-value는 귀무가설이 참이라고 가정했을 때, 표본에서 계산된 검정통계량보다 더 극단적인 값이 나올 확률을 말한다. 즉, p-value가 작을수록 귀무가설을 기각할 수 있는 근거가 더 강하다는 것을 의미한다. p-value는 유의수준보다 작을 때 귀무가설을 기각한다.

### p-value의 계산

- 검정통계량 Z 라 가정
- 양측검정일 때
    $$ p-value = 2 \times \int_{Z}^{\infty} f(z) dz $$

