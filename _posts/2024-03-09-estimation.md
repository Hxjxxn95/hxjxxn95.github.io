---
layout : post
title: 추정(Statistical Estimation)
author: Hojoon_Kim
date: 2024-03-09 14:15:10 +0900
categories: [Statistic]
tags: [Statistic, Statistic Estimation]
pin: true
math: true
---
## 점추정 및 점추정량의 성질
점추정은 모수를 하나의 수치로 추정하는 것을 말한다. 점추정량은 점추정을 수행하는 통계량을 말한다. 점추정량은 다음과 같은 성질을 가져야 한다.

### 불편추정량(Unbiased Estimator)
불편추정량은 추정량의 기댓값이 추정하려는 모수와 같은 추정량을 말한다. 즉, 추정량의 기댓값이 모수와 같다. 수식으로 나타내면 아래와 같다.

$$ E(\hat{\theta}) = \theta $$
- $\hat{\theta}$ : 추정량
- $\theta$ : 모수

### 효율추정량(Efficient Estimator)
효율추정량은 분산이 작은 추정량을 말한다. 즉, 분산이 작을수록 효율적인 추정량이다. 수식으로 나타내면 아래와 같다.

$$ Var(\hat{\theta}) = \frac{1}{I(\theta)} $$   

- $\hat{\theta}$ : 추정량
- $\theta$ : 모수
- $I(\theta)$ : 정보량

### 일치추정량(Consistent Estimator)
일치추정량은 표본의 크기가 커짐에 따라 추정량이 모수에 수렴하는 추정량을 말한다. 수식으로 나타내면 아래와 같다.

$$ \lim_{n \to \infty} P(|\hat{\theta} - \theta| < \epsilon) = 1 $$

- $\hat{\theta}$ : 추정량
- $\theta$ : 모수
- $n$ : 표본의 크기
- $\epsilon$ : 양수

### 모평균, 모분산, 모표준편차 의 점추정

#### 모평균의 점추정
모평균의 점추정량은 표본평균을 사용한다. 표본평균은 모평균의 불편추정량이다. 수식으로 나타내면 아래와 같다.

$$ \bar{X} = \frac{1}{n}\sum_{i=1}^{n}X_i $$

- $\bar{X}$ : 표본평균
- $X_i$ : i번째 표본
- $n$ : 표본의 크기

#### 모분산의 점추정

모분산의 점추정량은 표본분산을 사용한다. 표본분산은 모분산의 불편추정량이다. 수식으로 나타내면 아래와 같다.

$$ S^2 = \frac{1}{n-1}\sum_{i=1}^{n}(X_i - \bar{X})^2 $$

- $S^2$ : 표본분산
- $X_i$ : i번째 표본
- $\bar{X}$ : 표본평균
- $n$ : 표본의 크기

#### 모표준편차의 점추정

모표준편차의 점추정량은 표본표준편차를 사용한다. 표본표준편차는 모표준편차의 불편추정량이다. 수식으로 나타내면 아래와 같다.

$$ s = \sqrt{\frac{1}{n-1}\sum_{i=1}^{n}(X_i - \bar{X})^2} $$

- $s$ : 표본표준편차
- $X_i$ : i번째 표본
- $\bar{X}$ : 표본평균
- $n$ : 표본의 크기

* 유의사항 : $S^2$ 는 $\sigma^2$ 의 불편추정량이지만, $S$ 는 $\sigma$ 의 불편추정량이 아니다. 하지만 표본의 크기가 충분히 크다면, $S$ 는 $\sigma$ 의 불편추정량이 된다. 따라서 $s$ 를 수정하지 않고 $\sigma$ 로 사용한다.


## 모평균의 구간추정

### 모분산 $\sigma^2$을 아는 경우 모평균 $\mu$의 구간 추정
모분산 $\sigma^2$을 알고 있을 때 모평균 $\mu$의 구간 추정은 아래와 같이 수행한다.

$$ \bar{X} - z_{\frac{\alpha}{2}}\frac{\sigma}{\sqrt{n}} < \mu < \bar{X} + z_{\frac{\alpha}{2}}\frac{\sigma}{\sqrt{n}} $$

- $\bar{X}$ : 표본평균
- $\sigma$ : 모표준편차
- $n$ : 표본의 크기
- $z_{\frac{\alpha}{2}}$ : $\frac{\alpha}{2}$ 에 해당하는 z값( $\alpha$ : 신뢰수준, ex) 95% 신뢰수준일 때, $\alpha = 0.05$ 이므로, $\frac{\alpha}{2} = 0.025$ 이다. 따라서, $z_{0.025} = 1.96$ 이다.)

* 유의사항 : 모분산을 알고 있는 경우, 정규분포를 사용하여 구간 추정을 수행한다.

### 모분산 $\sigma^2$을 모르는 경우 모평균 $\mu$의 구간 추정
모분산 $\sigma^2$을 모르는 경우 모평균 $\mu$의 구간 추정은 아래와 같이 수행한다.

$$ \bar{X} - t_{\frac{\alpha}{2}}(n-1)\frac{s}{\sqrt{n}} < \mu < \bar{X} + t_{\frac{\alpha}{2}}(n-1)\frac{s}{\sqrt{n}} $$

- $\bar{X}$ : 표본평균
- $s$ : 표본표준편차
- $n$ : 표본의 크기
- $t_{\frac{\alpha}{2}} : \frac{\alpha}{2}$ 에 해당하는 t값( $\alpha$ : 신뢰수준)
- $n-1$ : 자유도

* 유의사항 : 모분산을 모르는 경우, t-분포를 사용하여 구간 추정을 수행한다. t-분포는 정규분포를 따르는 모집단에서 표본을 추출하여 표본 평균을 계산할 때, 표본 평균의 분포를 나타내는 확률분포이다. t-분포는 정규분포와 유사한 형태를 가지고 있으며, 표본의 크기가 작을 때 정규분포보다 두터운 꼬리를 가지고 있다. t-분포는 표본의 크기가 커질수록 정규분포에 가까워진다.

## 모분산의 구간추정

### 모평균 $\mu$를 아는 경우 모분산 $\sigma^2$의 구간 추정

$\chi^2$ - 통계량 정의에 따라

$$ \chi^2 = \sum_{i=1}^{n}\frac{(X_i - \mu)^2}{\sigma^2} $$

은 자유도가 n 인 카이제곱 분포를 따른다. 따라서, 모평균 $\mu$를 알고 있을 때 모분산 $\sigma^2$의 구간 추정은 아래와 같이 수행한다.

$$ \frac{\sum{(X_i - \mu)^2}}{\chi^2_{\frac{\alpha}{2}}(n)} < \sigma^2 < \frac{\sum{(X_i - \mu)^2}}{\chi^2_{1-\frac{\alpha}{2}}(n)} $$

- $\chi^2_{\frac{\alpha}{2}}(n)$ : $\frac{\alpha}{2}$ 에 해당하는 카이제곱값
- $\chi^2_{1-\frac{\alpha}{2}}(n)$ : $1-\frac{\alpha}{2}$ 에 해당하는 카이제곱값 <- 비대칭임
- $\sum{(X_i - \mu)^2}$ : 표본의 제곱합
- $n$ : 표본의 크기

### 모평균 $\mu$를 모르는 경우 모분산 $\sigma^2$의 구간 추정

모평균 $\mu$를 모르는 경우 모분산 $\sigma^2$의 구간 추정은 아래와 같이 수행한다.

$$ \frac{(n-1)s^2}{\chi^2_{\frac{\alpha}{2}}(n-1)} < \sigma^2 < \frac{(n-1)s^2}{\chi^2_{1-\frac{\alpha}{2}}(n-1)} $$

- $\chi^2_{\frac{\alpha}{2}}(n-1)$ : $\frac{\alpha}{2}$ 에 해당하는 카이제곱값
- $\chi^2_{1-\frac{\alpha}{2}}(n-1)$ : $1-\frac{\alpha}{2}$ 에 해당하는 카이제곱값 <- 비대칭임
- $s^2$ : 표본분산
- $n$ : 표본의 크기


## 모평균 차이에 대한 구간추정

### 두 모분산 $\sigma_1^2, \sigma_2^2$을 알고 있는 경우 두 모평균 $\mu_1 - \mu_2$의 차이에 대한 구간 추정

두 정규모집단 $N(\mu_1, \sigma_1^2), N(\mu_2, \sigma_2^2)$ 으로부터 $\bar{X_1} - \bar{X_2}$ 의 기댓값과 분산은 각각 다음과 같다.

$$ E(\bar{X_1} - \bar{X_2}) = \mu_1 - \mu_2 $$
$$ Var(\bar{X_1} - \bar{X_2}) = \frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2} $$

따라서 $\bar{X_1} - \bar{X_2}$ 의 Z-통계량은 다음과 같다.

$$ Z = \frac{(\bar{X_1} - \bar{X_2}) - (\mu_1 - \mu_2)}{\sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}} $$

따라서, 두 모분산 $\sigma_1^2, \sigma_2^2$을 알고 있는 경우 두 모평균 $\mu_1 - \mu_2$의 차이에 대한 구간 추정은 아래와 같이 수행한다.

$$ P((\bar{X_1} - \bar{X_2}) - z_{\frac{\alpha}{2}}\sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}} < \mu_1 - \mu_2 < (\bar{X_1} - \bar{X_2}) + z_{\frac{\alpha}{2}}\sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}) = 1-\alpha $$

- $\bar{X_1} - \bar{X_2}$ : 두 표본의 평균 차이
- $\sigma_1^2, \sigma_2^2$ : 두 모분산
- $n_1, n_2$ : 두 표본의 크기
- $z_{\frac{\alpha}{2}}$ : $\frac{\alpha}{2}$ 에 해당하는 z값( $\alpha$ : 신뢰수준)

* 유의사항 : 두 모분산을 알고 있는 경우, 정규분포를 사용하여 구간 추정을 수행한다.

### 두 모분산 $\sigma_1^2, \sigma_2^2$을 모르는 경우 두 모평균 $\mu_1 - \mu_2$의 차이에 대한 구간 추정

#### 대표본일 경우

두 정규모집단 $N(\mu_1, \sigma_1^2), N(\mu_2, \sigma_2^2)$ 에서 두 모분산 $\sigma_1^2, \sigma_2^2$을 모르는 경우 두 모평균 $\mu_1 - \mu_2$의 차이에 대한 구간 추정은 아래와 같이 수행한다.

$$ (\bar{X_1} - \bar{X_2}) - z_{\frac{\alpha}{2}}\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}} < \mu_1 - \mu_2 < (\bar{X_1} - \bar{X_2}) + z_{\frac{\alpha}{2}}\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}} $$

- $\bar{X_1} - \bar{X_2}$ : 두 표본의 평균 차이
- $s_1^2, s_2^2$ : 두 표본의 분산
- $n_1, n_2$ : 두 표본의 크기
- $z_{\frac{\alpha}{2}}$ : $\frac{\alpha}{2}$ 에 해당하는 z값( $\alpha$ : 신뢰수준)

* 유의사항 : 두 모집단의ㅡ 분포가 정규본포가 아닌 임의의 모집단에서 $n_1, n_2$ 가 충분히 크다면, 중심극한정리에 의해 정규분포를 따르기 때문에 정규분포를 사용하여 구간 추정을 수행한다.

#### 소표본일 경우

##### 두 모분산이 같은 경우($\sigma_1^2 = \sigma_2^2$)

두 집단의 모분산은 모르지만, 같다고 가정할 수 있는 경우에는 공통분산의 추정은 다음의 합동분산 추정량으로 사용한다.

$$ s_p^2 = \frac{(n_1-1)s_1^2 + (n_2-1)s_2^2}{n_1 + n_2 - 2} = \frac{\sum{(X_1 - \bar{X_1})^2} + \sum{(X_2 - \bar{X_2})^2}}{n_1 + n_2 - 2} $$

따라서 합동분산추정량 $s_p^2$ 을 사용하여 $\bar{X_1} - \bar{X_2}$ 의 t-통계량은 다음과 같다.

$$ t = \frac{(\bar{X_1} - \bar{X_2}) - (\mu_1 - \mu_2)}{s_p\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}} $$

따라서, 두 모분산이 같은 경우 두 모평균 $\mu_1 - \mu_2$의 차이에 대한 구간 추정은 아래와 같이 수행한다.

$$ (\bar{X_1} - \bar{X_2}) - t_{\frac{\alpha}{2}}(n_1 + n_2 - 2)s_p\sqrt{\frac{1}{n_1} + \frac{1}{n_2}} < \mu_1 - \mu_2 < (\bar{X_1} - \bar{X_2}) + t_{\frac{\alpha}{2}}(n_1 + n_2 - 2)s_p\sqrt{\frac{1}{n_1} + \frac{1}{n_2}} $$

- $\bar{X_1} - \bar{X_2}$ : 두 표본의 평균 차이
- $s_p^2$ : 합동분산추정량
- $n_1, n_2$ : 두 표본의 크기
- $t_{\frac{\alpha}{2}}$ : $\frac{\alpha}{2}$ 에 해당하는 t값( $\alpha$ : 신뢰수준)

* $ t^* = t_{\frac{\alpha}{2}}(n_1 + n_2 - 2) $ 를 사용하여, 다시 식에대해 정리하면 아래와 같다.

$$ (\bar{X_1} - \bar{X_2}) - t^*s_p\sqrt{\frac{1}{n_1} + \frac{1}{n_2}} < \mu_1 - \mu_2 < (\bar{X_1} - \bar{X_2}) + t^*s_p\sqrt{\frac{1}{n_1} + \frac{1}{n_2}} $$

##### 두 모분산이 다른 경우($\sigma_1^2 \neq \sigma_2^2$)

두 집단의 모분산이 다른 경우에는 두 모평균 $\mu_1 - \mu_2$의 차이에 대한 구간 추정은 아래와 같이 수행한다.

$$ (\bar{X_1} - \bar{X_2}) - t_{\frac{\alpha}{2}}(n^*)\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}} < \mu_1 - \mu_2 < (\bar{X_1} - \bar{X_2}) + t_{\frac{\alpha}{2}}(n^*)\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}} $$

- $\bar{X_1} - \bar{X_2}$ : 두 표본의 평균 차이
- $s_1^2, s_2^2$ : 두 표본의 분산
- $n_1, n_2$ : 두 표본의 크기
- $t_{\frac{\alpha}{2}}$ : $\frac{\alpha}{2}$ 에 해당하는 t값( $\alpha$ : 신뢰수준)
- $n^* = \frac{(\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2})^2}{\frac{(\frac{s_1^2}{n_1})^2}{n_1-1} + \frac{(\frac{s_2^2}{n_2})^2}{n_2-1}} $

